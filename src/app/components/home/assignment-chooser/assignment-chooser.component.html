<button class="btn btn-outline-secondary">
  <div>
    <span class="fa-layers fa-fw">
      <i class="fas fa-stream" data-fa-transform="right-4"></i>
      <i class="fas fa-chevron-right" data-fa-transform="shrink-8 down-5 left-9"></i>
      <i class="fas fa-chevron-down" data-fa-transform="shrink-8 up-5 left-9"></i>
    </span>
  </div>
</button>

<div>

  <ngx-datatable #assignmentsTable class="material expandable" [rows]="assignments" [groupRowsBy]="'year'"
    [columnMode]="'force'"  [headerHeight]="50" [footerHeight]="50" [rowHeight]="60" [limit]="10">
    <ngx-datatable-group-header #myGroupHeader>
      <ng-template let-group="group" let-expanded="expanded" ngx-datatable-group-header-template>
        <div class="group-div" style="padding-left:5px;">
          <span [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded"
            title="Expand/Collapse Group" (click)="toggleExpandGroup(group)">
            <b>{{ 'ASSIGNMENT-CHOOSER.YEAR' | translate }} : {{ group.key }}</b>
          </span>
        </div>
      </ng-template>
    </ngx-datatable-group-header>

    <ngx-datatable-column [width]="5" [resizeable]="false" [sortable]="false" [draggable]="false"
      [canAutoResize]="false">
    </ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.ID' | translate }}" prop="id"></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.TITLE' | translate }}" prop="title" ></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.COURSE' | translate }}" prop="course" ></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.PROGRAM' | translate }}" prop="program"></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.YEAR' | translate }}" prop="year"></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.LAST-MODIFICATION-DATE' | translate }}">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.lastModificationDate | date: 'short' }}
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column [sortable]="false">
      <ng-template let-column="column" ngx-datatable-header-template>
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-primary btn-sm" (click)="createAssignment()"
            [ngbTooltip]="createAssignmentTooltip">
            <i class="fas fa-plus"></i>
          </button>
          <button class="btn btn-secondary btn-sm" [ngbTooltip]="downloadTooltip" (click)="exportDB()"><i
              class="fas fa-download"></i></button>
          <input #assignmentFile type="file" (change)="changeListener($event)" hidden>
          <button class="btn btn-secondary btn-sm" (click)="assignmentFile.click();" [ngbTooltip]="uploadTooltip"><i
              class="fas fa-upload"></i></button>
        </div>
      </ng-template>

  <div class="details-div">
  <small>
    <a href="javascript:void(0)" (click)="table.rowDetail.expandAllRows()">Expand All</a>
    |
    <a href="javascript:void(0)" (click)="table.rowDetail.collapseAllRows()">Collapse All</a>
  </small>

  <ngx-datatable #assignmentsTable class="material" [rows]="assignments" [columnMode]="'force'" rowHeight="auto"
    headerHeight="auto" [sorts]="[{ prop: 'lastModificationDate', dir: 'desc' }]">

    <ngx-datatable-column [width]="50" [resizeable]="false" [sortable]="false" [draggable]="false"
      [canAutoResize]="false">
      <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
        <p [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded"
          (click)="toggleExpandRow(row)">
        </p>
      </ng-template>
    </ngx-datatable-column>


    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.ID' | translate }}" prop="id" [maxWidth]="65">
    </ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.TITLE' | translate }}" prop="title">
    </ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.COURSE' | translate }}" prop="course"></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.PROGRAM' | translate }}" prop="program">
    </ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.YEAR' | translate }}" prop="year"></ngx-datatable-column>
    <ngx-datatable-column name="{{ 'ASSIGNMENT-CHOOSER.LAST-MODIFICATION-DATE' | translate }}">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{ row.lastModificationDate | date: 'short' }}
      </ng-template>


      <ngx-datatable-row-detail rowHeight="auto" #myDetailRow (toggle)="onDetailToggle($event)">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
          <div style="padding-left:35px;">
            <div><strong>{{ 'ASSIGNMENT-CHOOSER.ASSIGNMENT-DETAILS.DETAILS-TITLE' | translate }}</strong></div>
            <div style="white-space: pre">{{ DetailDisplayer(row) }}</div>
          </div>
        </ng-template>
      </ngx-datatable-row-detail>



    </ngx-datatable-column>
    <ngx-datatable-column [maxWidth]="170" [sortable]="false">
      <ng-template let-column="column" ngx-datatable-header-template>
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-primary btn-sm" (click)="createAssignment()"
            [ngbTooltip]="createAssignmentTooltip">
            <i class="fas fa-plus"></i>
          </button>
          <button class="btn btn-secondary btn-sm" [ngbTooltip]="downloadTooltip" (click)="exportDB()"><i
              class="fas fa-download"></i></button>
          <input #assignmentFile type="file" (change)="changeListener($event)" hidden>
          <button class="btn btn-secondary btn-sm" (click)="assignmentFile.click();" [ngbTooltip]="uploadTooltip"><i
              class="fas fa-upload"></i></button>
        </div>

      </ng-template>
      <ng-template let-row="row" ngx-datatable-cell-template>
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-primary left-right-btn" (click)="selectAssignment(row)"
            [ngbTooltip]="selectAssignmentTooltip" [disabled]="!authService.isSignedIn()">
            <i class="far fa-arrow-alt-circle-right icon"></i>
          </button>
          <button type="button" class="btn btn-secondary spin-btn" (click)="openConfigurationModal(row)"
            [ngbTooltip]="editAssignmentTooltip">
            <i class="fas fa-cog icon"></i>
          </button>
          <button type="button" class="btn btn-danger fill-btn" (click)="deleteAssignment(row)"
            [ngbTooltip]="deleteAssignmentTooltip">
            <i class="far fa-trash-alt icon"></i>
          </button>
        </div>
      </ng-template>
    </ngx-datatable-column>
  </ngx-datatable>
</div>

<ng-template #importConfirmation>
  <div class="modal-header">
    <h4 class="modal-title">{{ "IMPORT-CONFIRMATION-TITLE" | translate }}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modalRef.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    {{ "IMPORT-CONFIRMATION-MESSAGE" | translate }}
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="modalRef.dismiss('Cancel')">
      {{ "CANCEL" | translate }}
    </button>
    <button type="button" class="btn btn-primary" (click)="modalRef.close('Confirm')">
      {{ "CONFIRM" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #createAssignmentTooltip>{{ 'HOME.CREATE-ASSIGNMENT-TOOLTIP' | translate }}</ng-template>
<ng-template #selectAssignmentTooltip>{{ 'HOME.SELECT-ASSIGNMENT-TOOLTIP' | translate }}</ng-template>
<ng-template #editAssignmentTooltip>{{ 'HOME.EDIT-ASSIGNMENT-TOOLTIP' | translate }}</ng-template>
<ng-template #deleteAssignmentTooltip>{{ 'HOME.DELETE-ASSIGNMENT-TOOLTIP' | translate }}</ng-template>
<ng-template #downloadTooltip>{{ 'EXPORT-ASSIGNMENTS-TOOLTIP' | translate }}</ng-template>
<ng-template #uploadTooltip>{{ 'IMPORT-ASSIGNMENTS-TOOLTIP' | translate }}</ng-template>